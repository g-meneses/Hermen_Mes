<!-- TEST_API_PRODUCCION.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Test API Producción</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Test API Producción</h1>
    
    <button onclick="testAPI()">Probar API</button>
    <button onclick="testCatalogos()">Probar Catálogos</button>
    
    <div id="results"></div>
    
    <script>
    const baseUrl = window.location.origin + '/mes_hermen';
    
    async function testAPI() {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '<p>Probando...</p>';
        
        try {
            // Test 1: Listar producciones
            const response = await fetch(baseUrl + '/api/produccion.php');
            const data = await response.json();
            
            const html = `
                <div class="test ${data.success ? 'success' : 'error'}">
                    <h3>Test 1: GET /api/produccion.php</h3>
                    <p><strong>Status:</strong> ${data.success ? 'SUCCESS ✓' : 'ERROR ✗'}</p>
                    <p><strong>Mensaje:</strong> ${data.message || 'OK'}</p>
                    <p><strong>Producciones:</strong> ${data.producciones ? data.producciones.length : 0}</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            
        } catch (error) {
            resultsDiv.innerHTML = `
                <div class="test error">
                    <h3>Error de Conexión</h3>
                    <p>${error.message}</p>
                </div>
            `;
        }
    }
    
    async function testCatalogos() {
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '<p>Probando catálogos...</p>';
        
        let html = '';
        
        try {
            // Test Turnos
            const resTurnos = await fetch(baseUrl + '/api/catalogos.php?tipo=turnos');
            const dataTurnos = await resTurnos.json();
            
            html += `
                <div class="test ${dataTurnos.success ? 'success' : 'error'}">
                    <h3>Test: Turnos</h3>
                    <p><strong>Status:</strong> ${dataTurnos.success ? 'SUCCESS ✓' : 'ERROR ✗'}</p>
                    <p><strong>Turnos:</strong> ${dataTurnos.turnos ? dataTurnos.turnos.length : 0}</p>
                    <pre>${JSON.stringify(dataTurnos, null, 2)}</pre>
                </div>
            `;
            
            // Test Usuarios
            const resUsuarios = await fetch(baseUrl + '/api/catalogos.php?tipo=usuarios');
            const dataUsuarios = await resUsuarios.json();
            
            html += `
                <div class="test ${dataUsuarios.success ? 'success' : 'error'}">
                    <h3>Test: Usuarios</h3>
                    <p><strong>Status:</strong> ${dataUsuarios.success ? 'SUCCESS ✓' : 'ERROR ✗'}</p>
                    <p><strong>Usuarios:</strong> ${dataUsuarios.usuarios ? dataUsuarios.usuarios.length : 0}</p>
                    <pre>${JSON.stringify(dataUsuarios, null, 2)}</pre>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            
        } catch (error) {
            resultsDiv.innerHTML = `
                <div class="test error">
                    <h3>Error de Conexión</h3>
                    <p>${error.message}</p>
                </div>
            `;
        }
    }
    </script>
</body>
</html>
